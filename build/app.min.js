var App={mode:null,navContainer:null,drawer:null,historyPage:null,mainPage:null,historyList:null,arrowPanel:null,refreshStateBar:null,selectPanel:null,timerPanel:null,randomButton:null,submitButton:null,noticeBar:null,currentState:!1,pageY:0,deltaY:0,offsetY:0,currentOffset:0,resistance:1,isScrolling:!1,lastRequestTime:0,selectedNums:0,init:function(){this.initDOM(),this.initNavBar(),this.initDrawerLayout(),this.initTimer(),this.initBottomPanel()},initDOM:function(){this.navContainer=document.querySelector(".nav-container"),this.drawer=document.querySelector(".drawer-layout"),this.historyPage=document.querySelector(".history-page"),this.mainPage=document.querySelector(".main-page"),this.historyList=document.querySelector(".history-list"),this.arrowPanel=document.querySelector(".arrow-panel"),this.refreshStateBar=document.querySelector(".refresh-state-bar"),this.selectPanel=document.querySelector(".select-panel"),this.timerPanel=document.querySelector(".timer-panel"),this.randomButton=document.querySelector(".random-button"),this.submitButton=document.querySelector(".submit-button"),this.noticeBar=document.querySelector(".notice-bar")},initNavBar:function(){var t=this;Data.getNavFlagData(function(e){for(var i in e)e[i]&&t.navContainer.children[i].classList.add("flag-icon")}),this.navContainer.addEventListener("click",function(e){var i=e.target;"LABEL"===e.target.tagName.toUpperCase()&&(i=e.target.parentNode),i.classList.contains("active")||(Utils.removeClass(t.navContainer,"active"),t.mode=parseInt(i.id),t.modeChanged(),i.classList.add("active"),t.currentState&&t.drawerLayoutToggle())},!1)},initDrawerLayout:function(){var t=this;this.currentOffset=-this.historyPage.clientHeight,this.historyList.addEventListener("touchstart",function(){t.historyList.scrollHeight-t.historyList.clientHeight>15&&(t.isScrolling=!0)},!1),this.historyList.addEventListener("touchend",function(){t.isScrolling=!1},!1),this.historyList.addEventListener("touchcancel",function(){t.isScrolling=!1},!1),this.drawer.addEventListener("touchstart",function(e){t.isScrolling||(t.pageY=e.touches[0].pageY,t.deltaY=0)},!1),this.drawer.addEventListener("touchmove",function(e){t.isScrolling||(t.deltaY=e.touches[0].pageY-t.pageY,t.pageY=e.touches[0].pageY,t.deltaY>0&&t.currentState||t.deltaY<0&&!t.currentState||t.currentOffset>0||Math.abs(t.currentOffset)>t.historyPage.clientHeight||(t.currentOffset=t.deltaY/t.resistance+t.currentOffset,e.preventDefault(),t.resistance=t.deltaY>0?t.pageY/t.historyPage.clientHeight+1.15:t.deltaY<0?Math.abs(t.pageY)/t.historyPage.clientHeight+1.15:1,t.historyPage.style.webkitTransform="translate3d(0, "+t.currentOffset+"px, 0)",t.mainPage.style.webkitTransform="translate3d(0, "+t.currentOffset+"px, 0)"))},!1),this.drawer.addEventListener("touchend",function(e){t.isScrolling||(t.offsetY=t.currentState?Math.abs(t.currentOffset):t.historyPage.clientHeight-Math.abs(t.currentOffset),t.offsetY>.15*t.historyPage.clientHeight?t.drawerLayoutToggle():t.drawLayoutAnimate())},!1),this.drawer.addEventListener("stateChange",function(e){event.preventDefault(),e.detail.state?t.openedHandler():t.closedHandler()})},getSelectedList:function(){for(var t=[],e=0,i=this.selectPanel.children.length;i>e;e++)this.selectPanel.children[e].classList.contains("active")&&t.push(parseInt(this.selectPanel.children[e].innerText));return t},initBottomPanel:function(){var t=this;this.randomButton.addEventListener("click",function(e){t.currentState&&t.drawerLayoutToggle(),Utils.removeClass(t.selectPanel,"active");var i=Utils.getRandomList(5);for(var a in i)t.selectPanel.children[i[a]-1].classList.add("active");t.selectedNums=5},!1),this.submitButton.addEventListener("click",function(e){if(t.currentState&&t.drawerLayoutToggle(),t.selectedNums<2)return void alert("至少选择两个");var i=t.getSelectedList();alert("你选择了"+i.join(","))},!1),this.selectPanel.addEventListener("click",function(e){var i=e.target;if("SPAN"===i.tagName.toUpperCase())return i.classList.contains("active")?(i.classList.remove("active"),void t.selectedNums--):void(5!==t.selectedNums&&(i.classList.add("active"),t.selectedNums++))},!1)},modeChanged:function(){Utils.removeClass(this.selectPanel,"active"),this.selectedNums=0},initTimer:function(){function t(){var t=e-+new Date,r=parseInt(t/1e3/60/60%24,10),s=parseInt(t/1e3/60%60,10),l=parseInt(t/1e3%60,10);if(i.timerPanel.innerHTML="距离50期截止 <b>"+(r>9?r:"0"+r)+":"+(s>9?s:"0"+s)+":"+(l>9?l:"0"+l)+"</b>",n++,a&&n%8===0){var o=n/8%a.length;i.noticeBar.children[0].innerHTML=a[o]}}var e=new Date(+new Date+36e6),i=this,a=null,n=0;Data.getNoticeList(function(t){a=t}),setInterval(t,1e3)},openedHandler:function(){var t=this;this.selectPanelOperation("hide"),this.arrowPanelOperation("up"),+new Date-this.lastRequestTime>8e3&&(this.refreshBar("loading"),Data.getHistoryList(function(e){t.lastRequestTime=+new Date,t.refreshBar("success");var i=Template.compile("historyLine",e);t.historyList.children[0].innerHTML="",t.historyList.children[0].innerHTML=i}))},refreshBar:function(t){var e=this;"loading"===t&&(this.refreshStateBar.classList.remove("success"),this.refreshStateBar.classList.add("loading"),this.refreshStateBar.children[0].innerHTML="正在刷新...",this.refreshStateBar.style["-webkit-transition-duration"]=".2s",this.refreshStateBar.style.webkitTransform="translate3d(0, 0, 0)"),"success"===t&&(this.refreshStateBar.classList.remove("loading"),this.refreshStateBar.classList.add("success"),this.refreshStateBar.children[0].innerHTML="刷新成功",setTimeout(function(){e.refreshStateBar.style["-webkit-transition-duration"]=".2s",e.refreshStateBar.style.webkitTransform="translate3d(0, 100%, 0)"},2e3))},closedHandler:function(){this.selectPanelOperation("show"),this.arrowPanelOperation("down")},selectPanelOperation:function(t){"show"===t?(this.selectPanel.style["-webkit-transition-duration"]=".5s",this.selectPanel.style.opacity=1):"hide"===t&&(this.selectPanel.style["-webkit-transition-duration"]=".5s",this.selectPanel.style.opacity=0)},drawerLayoutToggle:function(){this.currentState=!this.currentState;var t=new CustomEvent("stateChange",{detail:{state:this.currentState},bubbles:!0,cancelable:!0});this.drawer.dispatchEvent(t),this.drawLayoutAnimate()},drawLayoutAnimate:function(){this.currentOffset=this.currentState?0:-this.historyPage.clientHeight,this.historyPage.style["-webkit-transition-duration"]=".2s",this.historyPage.style.webkitTransform="translate3d(0, "+this.currentOffset+"px, 0)",this.mainPage.style["-webkit-transition-duration"]=".2s",this.mainPage.style.webkitTransform="translate3d(0, "+this.currentOffset+"px, 0)"},arrowPanelOperation:function(t){"down"===t&&(this.arrowPanel.classList.add("down"),this.arrowPanel.innerHTML="下拉历史开奖"),"up"===t&&(this.arrowPanel.classList.remove("down"),this.arrowPanel.innerHTML="上滑收起")}};
var Data={getNavFlagData:function(t){var n=[1,0,1,0,1];setTimeout(function(){t(n)},1e3)},getHistoryList:function(t){for(var n=[],a=0;10>a;a++)n.push({stage:49-a,numbers:Utils.getRandomList(5)});setTimeout(function(){t(n)},2e3)},getNoticeList:function(t){var n=["猜中任意三个开奖号码, 单注奖<span>26元</span>, 再加奖<span>4元</span>","至少选择2个球，猜中任意2个，中13块钱"];setTimeout(function(){t(n)},2e3)}};
var Template={historyLine:function(s){var n="";n+='<section class="history-line"><span class="history-header">'+s.stage+"期</span>";for(var r in s.numbers)n+='<span class="history-item">'+(s.numbers[r]>9?s.numbers[r]:"0"+s.numbers[r])+"</span>";return n+="</section>"},compile:function(s,n){for(var r="",e=0,t=n.length;t>e;e++)r+=this[s](n[e]);return r}};
var Utils={removeClass:function(r,t){r.classList.remove(t);for(var e=0,n=r.children.length;n>e;e++)r.children[e].classList.remove(t)},has:function(r,t){for(var e=0,n=r.length;n>e;e++)if(r[e]===t)return!0;return!1},getRandomList:function(r){var t=0,e=[];do{var n=Math.floor(11*Math.random()+1);this.has(e,n)||(e.push(n),t++)}while(r>t);return e}};